<?xml version="1.0" encoding="utf-8"?>

<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodel="clr-namespace:DruidsCornerApp.ViewModels.MainContext"
             xmlns:view="clr-namespace:DruidsCornerApp.Views.MainContext"
             xmlns:model="clr-namespace:DruidsCornerApp.Models.MainContext"
             xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             xmlns:system="clr-namespace:System;assembly=System.Runtime"
             xmlns:generic="clr-namespace:System.Collections.Generic;assembly=System.Collections"
             x:Class="DruidsCornerApp.Views.MainContext.HopReferenceView">

    <Grid RowDefinitions="*">
        <ScrollView Grid.Row="0"
                    x:Name="TopScrollView">
            <!-- Top grid -->
            <Grid RowDefinitions="auto,*,auto">
                
                <!-- Search and filter parameters -->
                <Grid RowDefinitions="*,auto,*"
                      Padding="0,2"
                      ColumnSpacing="2"
                      RowSpacing="2">
                    
                    <!-- Hop names entry -->
                    <Frame Grid.Row="0"
                           BorderColor="Orange"
                           CornerRadius="10"
                           Padding="10,0"
                           Margin="0,0">
                        <Grid ColumnDefinitions="*,auto"
                              RowDefinitions="*">
                            <Entry Grid.Column="0" 
                                   x:Name="HopNameTextEntry"
                                   Placeholder="Search for hop names here"
                                   PlaceholderColor="LightCoral"
                                   FontAttributes="Italic"
                                   TextColor="Orange" />
                            
                            <!-- The "+" button that lets you enter new labels -->
                            <ImageButton Grid.Column="1"
                                         Source="plus_sign.svg"
                                         HeightRequest="25"
                                         WidthRequest="25"
                                         BackgroundColor="Orange"
                                         CornerRadius="15"
                                         Margin="0,5"
                                         x:DataType="viewmodel:ReferencesPageViewModel"
                                         Command="{Binding AddHopNameFilterLabelCommand}"
                                         CommandParameter="{x:Reference HopNameTextEntry}"
                                />
                        </Grid>
                    </Frame>
                    
                    <!-- Names tags list -->
                    <CollectionView Grid.Row="1" 
                                    x:Name="NamesList"
                                    x:DataType="viewmodel:ReferencesPageViewModel"
                                    ItemsSource="{Binding HopsNames}"
                                    ItemsLayout="HorizontalList">
                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <Frame CornerRadius="10"
                                       BackgroundColor="WhiteSmoke"
                                       BorderColor="Orange">

                                    <Grid ColumnDefinitions="auto,auto">
                                        <Label Grid.Column="1" Text="{Binding }"
                                                BackgroundColor="WhiteSmoke"
                                                TextColor="Orange"
                                                HorizontalOptions="Start"
                                                VerticalOptions="Center"/>
                                        <ImageButton Source="minus_sign.svg"
                                                     BackgroundColor="Orange"
                                                     HeightRequest="25"
                                                     WidthRequest="25"
                                                     CornerRadius="15"
                                                     HorizontalOptions="End"
                                                     VerticalOptions="Center"/>
                                        
                                    </Grid>
                                </Frame>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                    <Grid Grid.Row="2"
                          ColumnDefinitions="auto,*,auto"
                          HeightRequest="30">
                        <Button Grid.Column="0"
                                Text="Advanced search filters"
                                BackgroundColor="WhiteSmoke"
                                TextColor="#222222"
                                CornerRadius="15"
                                Padding="8,0"/>
                        <Button Grid.Column="2"
                                Text="Go !"
                                TextColor="White"
                                BackgroundColor="Orange"
                                CornerRadius="15"
                                Padding="5,0">
                        </Button>
                    </Grid>
                </Grid>
                
                
                
                <CollectionView x:DataType="viewmodel:ReferencesPageViewModel"
                                x:Name="DataCollectionView"
                                Grid.Row="1"
                                ItemsSource="{Binding Path=Hops}">
                    <CollectionView.ItemTemplate>
                        <DataTemplate x:DataType="model:CompactHopModel">
                            <Frame BackgroundColor="#2b2b2b"
                                   CornerRadius="10"
                                   Margin="0"
                                   Padding="10"
                                   BorderColor="Transparent">

                                <Grid ColumnSpacing="10"
                                      ColumnDefinitions="auto,*,auto,auto">
                                    <!-- Hop thumbnail -->
                                    <Frame Grid.Column="0"
                                           CornerRadius="100"
                                           BorderColor="Transparent"
                                           Margin="0,0,10,0"
                                           Padding="0">
                                        <Image
                                            WidthRequest="80"
                                            HeightRequest="80"
                                            Aspect="AspectFit"
                                            HorizontalOptions="Center"
                                            VerticalOptions="Center"
                                            Source="hop_image.png" />
                                    </Frame>

                                    <!-- Hop name, id -->
                                    <Grid Grid.Column="1"
                                          ColumnDefinitions="auto,auto,auto"
                                          RowDefinitions="auto,auto,auto"
                                          ColumnSpacing="5">

                                        <Label Grid.Column="0"
                                               Grid.Row="0"
                                               Grid.ColumnSpan="2"
                                               TextColor="White"
                                               Text="{Binding Name}"
                                               FontSize="15"
                                               Padding="0,0,0,5"
                                               FontAttributes="Bold" />

                                        <Label Grid.Column="0"
                                               Grid.Row="1"
                                               TextColor="White"
                                               Text="Alpha acids :"
                                               Padding="0,0,0,5" />
                                        <Label Grid.Column="1"
                                               Grid.Row="1"
                                               TextColor="White"
                                               Text="{Binding AlphaAcids}"
                                               FontAttributes="Italic" />

                                        <Label Grid.Column="0"
                                               Grid.Row="2"
                                               TextColor="White"
                                               Text="Purpose :" />
                                        <Label Grid.Column="1"
                                               Grid.Row="2"
                                               TextColor="White"
                                               Text="{Binding Purpose}"
                                               FontAttributes="Italic" />

                                    </Grid>

                                    <!-- Qr code, favorite, etc. -->
                                    <Grid Grid.Column="2"
                                          RowDefinitions="auto,*,auto"
                                          HorizontalOptions="End"
                                          Padding="0">

                                        <Image Grid.Row="0"
                                               Source="heart.svg"
                                               HeightRequest="20"
                                               WidthRequest="20"
                                               HorizontalOptions="End"
                                               VerticalOptions="Start" />

                                        <HorizontalStackLayout Grid.Row="2"
                                                               Spacing="10"
                                                               Padding="0"
                                                               VerticalOptions="End"
                                                               HorizontalOptions="End">
                                            <HorizontalStackLayout>
                                                <Image Source="star.svg"
                                                       HeightRequest="20"
                                                       WidthRequest="20"
                                                       VerticalOptions="Center"
                                                       HorizontalOptions="Center">
                                                    <Image.Behaviors>
                                                        <toolkit:IconTintColorBehavior TintColor="#ff6a00" />
                                                    </Image.Behaviors>
                                                </Image>
                                                <Label Text="{Binding Rating}"
                                                       TextColor="#ff6a00"
                                                       VerticalOptions="Center" />
                                                <Label Text="/5"
                                                       TextColor="#ff6a00"
                                                       VerticalOptions="Center" />
                                            </HorizontalStackLayout>
                                            <Image Source="qrcode.svg"
                                                   HeightRequest="25"
                                                   WidthRequest="25">
                                                <Image.Behaviors>
                                                    <toolkit:IconTintColorBehavior TintColor="#ff6a00" />
                                                </Image.Behaviors>
                                            </Image>
                                        </HorizontalStackLayout>
                                    </Grid>
                                </Grid>
                            </Frame>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
                <Button Grid.Row="2"
                        Text="Add fake hop !"
                        x:DataType="viewmodel:ReferencesPageViewModel"
                        Command="{Binding Path=AddOneHopCommand}">

                </Button>
            </Grid>
            
        </ScrollView>
        
        <!-- Go up button - lets the user go to the top of the scrolling list -->
        <ImageButton Grid.Row="0"
                     HorizontalOptions="End"
                     VerticalOptions="End"
                     BackgroundColor="#222222"
                     IsVisible="True"
                     Clicked="GoUpButtonClicked"
                     Padding="2"
                     Margin="20"
                     CornerRadius="20"
                     HeightRequest="40"
                     WidthRequest="40"
                     Source="about.svg">
        </ImageButton>
    </Grid>
</ContentView>